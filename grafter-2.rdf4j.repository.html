<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>grafter-2.rdf4j.repository documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Grafter</span> <span class="project-version">2.0.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>grafter-2</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rdf</span></div></div></li><li class="depth-3"><a href="grafter-2.rdf.protocols.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocols</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>rdf4j</span></div></div></li><li class="depth-3 branch"><a href="grafter-2.rdf4j.formats.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>formats</span></div></a></li><li class="depth-3 branch"><a href="grafter-2.rdf4j.io.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></a></li><li class="depth-3 current"><a href="grafter-2.rdf4j.repository.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>repository</span></div></a></li><li class="depth-4"><a href="grafter-2.rdf4j.repository.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-3 branch"><a href="grafter-2.rdf4j.sparql.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>sparql</span></div></a></li><li class="depth-3"><a href="grafter-2.rdf4j.templater.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>templater</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>grafter</span></div></div></li><li class="depth-2"><a href="grafter.rdf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>rdf</span></div></a></li><li class="depth-3 branch"><a href="grafter.rdf.formats.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>formats</span></div></a></li><li class="depth-3 branch"><a href="grafter.rdf.io.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></a></li><li class="depth-3 branch"><a href="grafter.rdf.protocols.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocols</span></div></a></li><li class="depth-3"><a href="grafter.rdf.repository.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>repository</span></div></a></li><li class="depth-4"><a href="grafter.rdf.repository.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-3 branch"><a href="grafter.rdf.sparql.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>sparql</span></div></a></li><li class="depth-3"><a href="grafter.rdf.templater.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>templater</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-add-.3Erepo"><div class="inner"><span>add-&gt;repo</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-custom-query-inferencer"><div class="inner"><span>custom-query-inferencer</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-direct-type-inferencer"><div class="inner"><span>direct-type-inferencer</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-fixture-repo"><div class="inner"><span>fixture-repo</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-http-repo"><div class="inner"><span>http-repo</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-IPrepareQuery"><div class="inner"><span>IPrepareQuery</span></div></a></li><li class="depth-2"><a href="grafter-2.rdf4j.repository.html#var-prepare-query*"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>prepare-query*</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-IQueryEvaluator"><div class="inner"><span>IQueryEvaluator</span></div></a></li><li class="depth-2"><a href="grafter-2.rdf4j.repository.html#var-evaluate"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>evaluate</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-make-restricted-dataset"><div class="inner"><span>make-restricted-dataset</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-memory-store"><div class="inner"><span>memory-store</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-native-store"><div class="inner"><span>native-store</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-notifying-repo"><div class="inner"><span>notifying-repo</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-prepare-query"><div class="inner"><span>prepare-query</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-prepare-update"><div class="inner"><span>prepare-update</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-query"><div class="inner"><span>query</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-rdfs-inferencer"><div class="inner"><span>rdfs-inferencer</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-resource-repo"><div class="inner"><span>resource-repo</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-sail-repo"><div class="inner"><span>sail-repo</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-shutdown"><div class="inner"><span>shutdown</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-sparql-repo"><div class="inner"><span>sparql-repo</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-throw-deprecated-exception.21"><div class="inner"><span>throw-deprecated-exception!</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-ToConnection"><div class="inner"><span>ToConnection</span></div></a></li><li class="depth-2"><a href="grafter-2.rdf4j.repository.html#var--.3Econnection"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>-&gt;connection</span></div></a></li><li class="depth-1"><a href="grafter-2.rdf4j.repository.html#var-with-transaction"><div class="inner"><span>with-transaction</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">grafter-2.rdf4j.repository</h1><h4 class="added">added in 0.12.1</h4><div class="doc"><pre class="plaintext">Functions for constructing and working with various RDF4j repositories.
</pre></div><div class="public anchor" id="var-add-.3Erepo"><h3>add-&gt;repo</h3><div class="usage"><code>(add-&gt;repo repo)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L215">view source</a></div></div><div class="public anchor" id="var-custom-query-inferencer"><h3>custom-query-inferencer</h3><div class="usage"><code>(custom-query-inferencer)</code><code>(custom-query-inferencer query-text matcher-text)</code><code>(custom-query-inferencer notifying-sail query-text matcher-text)</code></div><div class="doc"><pre class="plaintext">A forward-chaining inferencer that infers new statements using a
SPARQL graph query.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L191">view source</a></div></div><div class="public anchor" id="var-direct-type-inferencer"><h3>direct-type-inferencer</h3><div class="usage"><code>(direct-type-inferencer)</code><code>(direct-type-inferencer notifying-sail)</code></div><div class="doc"><pre class="plaintext">A forward-chaining inferencer that infers the direct-type hierarchy
relations sesame:directSubClassOf, sesame:directSubPropertyOf and
sesame:directType.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L182">view source</a></div></div><div class="public anchor" id="var-fixture-repo"><h3>fixture-repo</h3><div class="usage"><code>(fixture-repo)</code><code>(fixture-repo repo-or-data &amp; data)</code></div><div class="doc"><pre class="plaintext">adds the specified data to a sparql repository.  if the first
argument is a repository that object is used, otherwise the first
and remaining arguments are assumed to be
grafter-2.core/ITripleWriteable and are loaded into a sesame
memorystore sail-repo.

this function is most useful for loading fixture data from files e.g.

(fixture-repo "test-data.trig" "more-test-data.trig")</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L232">view source</a></div></div><div class="public anchor" id="var-http-repo"><h3>http-repo</h3><div class="usage"><code>(http-repo repo-url)</code></div><div class="doc"><pre class="plaintext">Given a URL as a String return a Sesame HTTPRepository for e.g.
interacting with the OpenRDF Workbench.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L134">view source</a></div></div><div class="public anchor" id="var-IPrepareQuery"><h3>IPrepareQuery</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-prepare-query*"><h3>prepare-query*</h3><div class="usage"><code>(prepare-query* this sparql-string restriction)</code></div><div class="doc"><pre class="plaintext">Low level function to prepare (parse, but not process) a sesame RDF
query.  Takes a repository a query string and an optional sesame
Dataset to act as a query restriction.

Prepared queries still need to be evaluated with evaluate.</pre></div></div></div></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L413">view source</a></div></div><div class="public anchor" id="var-IQueryEvaluator"><h3>IQueryEvaluator</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-evaluate"><h3>evaluate</h3><div class="usage"><code>(evaluate this)</code></div><div class="doc"><pre class="plaintext">Low level protocol to evaluate a sesame RDF Query
object, and convert the results into a grafter representation.</pre></div></div></div></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L391">view source</a></div></div><div class="public anchor" id="var-make-restricted-dataset"><h3>make-restricted-dataset</h3><div class="usage"><code>(make-restricted-dataset &amp; {:as options})</code></div><div class="doc"><pre class="plaintext">Build a dataset to act as a graph restriction.  You can specify for
both `:default-graph` and `:named-graphs`.  Both of which take sequences
of URI strings.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L530">view source</a></div></div><div class="public anchor" id="var-memory-store"><h3>memory-store</h3><div class="usage"><code>(memory-store)</code></div><div class="doc"><pre class="plaintext">Instantiate a sesame RDF MemoryStore.
</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L122">view source</a></div></div><div class="public anchor" id="var-native-store"><h3>native-store</h3><div class="usage"><code>(native-store datadir)</code><code>(native-store datadir indexes)</code></div><div class="doc"><pre class="plaintext">Instantiate a sesame RDF NativeStore.
</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L127">view source</a></div></div><div class="public anchor" id="var-notifying-repo"><h3>notifying-repo</h3><div class="usage"><code>(notifying-repo repo)</code><code>(notifying-repo repo report-deltas)</code></div><div class="doc"><pre class="plaintext">Wrap the given repository in an RDF4j NotifyingRepositoryWrapper.
Once wrapped you can capture events on the underlying repository.

Supports two arities:

- Takes just a repo to wrap.
- Takes a repo to wrap and a boolean indicating whether to report
  deltas on operations.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L153">view source</a></div></div><div class="public anchor" id="var-prepare-query"><h3>prepare-query</h3><div class="usage"><code>(prepare-query repo sparql-string)</code><code>(prepare-query repo sparql-string restriction)</code></div><div class="doc"><pre class="plaintext">Low level function to prepare (parse, but not process) a sesame RDF
query.  Takes a repository a query string and an optional sesame
Dataset to act as a query restriction.

Prepared queries still need to be evaluated with evaluate.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L438">view source</a></div></div><div class="public anchor" id="var-prepare-update"><h3>prepare-update</h3><div class="usage"><code>(prepare-update repo sparql-update-str)</code><code>(prepare-update repo sparql-update-str dataset)</code></div><div class="doc"><pre class="plaintext">Prepare (parse but don't process) a SPARQL update request.

Prepared updates still need to be evaluated with evaluate.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L448">view source</a></div></div><div class="public anchor" id="var-query"><h3>query</h3><div class="usage"><code>(query repo sparql &amp; {:as options, :keys [prefixes]})</code></div><div class="doc"><pre class="plaintext">Run an arbitrary SPARQL query.  Works with ASK, DESCRIBE, CONSTRUCT
and SELECT queries.

You can call this on a Repository however if you do you may in some
cases cause a resource leak, for example if the sequence of results
isn't fully consumed.

To use this without leaking resources it is recommended that you
call -&gt;connection on your repository, inside a with-open; and then
consume all your results inside of a nested doseq/dorun/etc...

e.g.

````
(with-open [conn (-&gt;connection repo)]
   (doseq [res (query conn "SELECT * WHERE { ?s ?p ?o .}")]
      (println res)))
````

Takes a repo and sparql string and an optional set of k/v argument
pairs, and executes the sparql query on the repository.

Options are:

- `:default-graph` a seq of URI strings representing named graphs to be set
  as the default union graph for the query.

- `:named-graphs` a seq of URI strings representing the named graphs in
  to be used in the query.

If no options are passed then we use the default of no graph
restrictions whilst the union graph is the union of all graphs.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L564">view source</a></div></div><div class="public anchor" id="var-rdfs-inferencer"><h3>rdfs-inferencer</h3><div class="usage"><code>(rdfs-inferencer)</code><code>(rdfs-inferencer notifying-sail)</code></div><div class="doc"><pre class="plaintext">Returns a Sesame ForwardChainingRDFSInferencer using the rules from
the RDF Semantics Recommendation (10 February 2004).

You can instantiate a repository with a memory store or a native
store or with any SAIL that returns InferencerConnections.  e.g. to
instantiate a repository with a memory-store:

`(repo (rdfs-inferencer (memory-store)))`</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L167">view source</a></div></div><div class="public anchor" id="var-resource-repo"><h3>resource-repo</h3><div class="usage"><code>(resource-repo)</code><code>(resource-repo repo-or-data &amp; data)</code></div><div class="doc"><pre class="plaintext">Like fixture repo but assumes all supplied data is on the java
resource path.  For example:

(repo/resource-repo "grafter/rdf/sparql/sparql-data.trig"
                    "grafter/rdf/rdf-types.trig")

Will load the supplied RDF files from the resource path into a
single memory repository for testing.

If you want to use a custom repository the first argument can be a
repository.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L256">view source</a></div></div><div class="public anchor" id="var-sail-repo"><h3>sail-repo</h3><div class="usage"><code>(sail-repo)</code><code>(sail-repo sail)</code></div><div class="doc"><pre class="plaintext">Given a sesame Sail of some type, return a sesame SailRepository.

Finally you can also optionally supply a sesame sail to wrap the
repository, which can be used to configure a sesame NativeStore.

By default this function will return a repository initialised with a
Sesame MemoryStore.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L202">view source</a></div></div><div class="public anchor" id="var-shutdown"><h3>shutdown</h3><div class="usage"><code>(shutdown repo)</code></div><div class="doc"><pre class="plaintext">Cleanly shutsdown the repository.
</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L615">view source</a></div></div><div class="public anchor" id="var-sparql-repo"><h3>sparql-repo</h3><div class="usage"><code>(sparql-repo query-url)</code><code>(sparql-repo query-url update-url)</code></div><div class="doc"><pre class="plaintext">Given a query-url (String or IURI) and an optional update-url String
or IURI, return a Sesame SPARQLRepository for communicating with
remote repositories.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L141">view source</a></div></div><div class="public anchor" id="var-throw-deprecated-exception.21"><h3>throw-deprecated-exception!</h3><div class="usage"><code>(throw-deprecated-exception!)</code></div><div class="doc"><pre class="plaintext">Throw a more helpful error message alerting people to the need to
change code.

This is technically a breaking change, but it should indicate sites
which have a bug in them anyway.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L79">view source</a></div></div><div class="public anchor" id="var-ToConnection"><h3>ToConnection</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var--.3Econnection"><h3>-&gt;connection</h3><div class="usage"><code>(-&gt;connection repo)</code></div><div class="doc"><pre class="plaintext">Given an RDF4j repository return a connection to it.
-&gt;connection is designed to be used with the macro with-open</pre></div></div></div></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L24">view source</a></div></div><div class="public anchor" id="var-with-transaction"><h3>with-transaction</h3><h4 class="type">macro</h4><div class="usage"><code>(with-transaction repo &amp; forms)</code></div><div class="doc"><pre class="plaintext">Wraps the given forms in a transaction on the supplied repository.
Exceptions are rolled back on failure.</pre></div><div class="src-link"><a href="http://github.com/Swirrl/grafter/blob/rdf-core/src/grafter_2/rdf4j/repository.clj#L307">view source</a></div></div></div></body></html>